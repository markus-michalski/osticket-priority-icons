/**
 * Priority Icons - Stylesheet
 *
 * Visual styling for priority indicators in osTicket Staff Panel.
 * Uses CSS custom properties for easy color customization.
 *
 * @package    osTicket\Plugins\PriorityIcons
 * @author     Markus Michalski
 * @version    1.0.0
 */

/* ==========================================================================
   CSS Custom Properties (Design Tokens)
   ========================================================================== */

:root {
    /* Priority Colors (Bootstrap-inspired) */
    --priority-emergency: #dc3545;
    --priority-high: #fd7e14;
    --priority-normal: #ffc107;
    --priority-low: #28a745;

    /* Icon Sizing */
    --priority-icon-size: 12px;
    --priority-icon-spacing: 0.375rem;

    /* Tooltip */
    --priority-tooltip-bg: #212529;
    --priority-tooltip-color: #fff;
    --priority-tooltip-radius: 0.25rem;
    --priority-tooltip-padding: 0.25rem 0.5rem;
    --priority-tooltip-font-size: 0.6875rem;

    /* Transitions */
    --priority-transition-duration: 150ms;
    --priority-transition-timing: ease-in-out;
}

/* ==========================================================================
   Priority Icon Base Styles
   ========================================================================== */

/**
 * Base priority icon component.
 *
 * Creates a circular color indicator with hover effects.
 * Color is set via --priority-color custom property.
 */
.priority-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: var(--priority-icon-size);
    height: var(--priority-icon-size);
    border-radius: 50%;
    background-color: var(--priority-color, #6c757d);
    margin-inline-end: var(--priority-icon-spacing);
    vertical-align: middle;
    position: relative;
    cursor: help;
    flex-shrink: 0;
    transition:
        transform var(--priority-transition-duration) var(--priority-transition-timing),
        box-shadow var(--priority-transition-duration) var(--priority-transition-timing);
}

/**
 * Hover state - subtle scale and glow effect.
 */
.priority-icon:hover {
    transform: scale(1.2);
    box-shadow: 0 0 0 3px color-mix(in srgb, var(--priority-color) 25%, transparent);
}

/* ==========================================================================
   Priority-Specific Color Modifiers
   ========================================================================== */

.priority-icon.priority-emergency {
    --priority-color: var(--priority-emergency);
    animation: priority-pulse 1.5s ease-in-out infinite;
}

.priority-icon.priority-high {
    --priority-color: var(--priority-high);
}

.priority-icon.priority-normal {
    --priority-color: var(--priority-normal);
}

.priority-icon.priority-low {
    --priority-color: var(--priority-low);
}

/* ==========================================================================
   Emergency Pulse Animation
   ========================================================================== */

/**
 * Pulsing animation for emergency priority.
 * Draws attention to urgent tickets.
 */
@keyframes priority-pulse {
    0%,
    100% {
        box-shadow: 0 0 0 0 color-mix(in srgb, var(--priority-emergency) 70%, transparent);
    }
    50% {
        box-shadow: 0 0 0 4px color-mix(in srgb, var(--priority-emergency) 0%, transparent);
    }
}

/**
 * Disable animation for users who prefer reduced motion.
 * WCAG 2.1 accessibility requirement.
 */
@media (prefers-reduced-motion: reduce) {
    .priority-icon.priority-emergency {
        animation: none;
    }

    .priority-icon {
        transition: none;
    }
}

/* ==========================================================================
   CSS-only Tooltip
   ========================================================================== */

/**
 * Tooltip content (::after pseudo-element).
 * Shows priority name on hover.
 */
.priority-icon::after {
    content: attr(title);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(-0.25rem);
    padding: var(--priority-tooltip-padding);
    background-color: var(--priority-tooltip-bg);
    color: var(--priority-tooltip-color);
    font-size: var(--priority-tooltip-font-size);
    font-weight: 500;
    white-space: nowrap;
    border-radius: var(--priority-tooltip-radius);
    opacity: 0;
    visibility: hidden;
    transition:
        opacity var(--priority-transition-duration) var(--priority-transition-timing),
        visibility var(--priority-transition-duration) var(--priority-transition-timing);
    z-index: 1000;
    pointer-events: none;
}

/**
 * Tooltip arrow (::before pseudo-element).
 */
.priority-icon::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(0.25rem);
    border: 4px solid transparent;
    border-top-color: var(--priority-tooltip-bg);
    opacity: 0;
    visibility: hidden;
    transition:
        opacity var(--priority-transition-duration) var(--priority-transition-timing),
        visibility var(--priority-transition-duration) var(--priority-transition-timing);
    z-index: 1000;
}

/**
 * Show tooltip on hover.
 */
.priority-icon:hover::after,
.priority-icon:hover::before {
    opacity: 1;
    visibility: visible;
}

/* ==========================================================================
   Wrapper & Accessibility Support
   ========================================================================== */

/**
 * Wrapper containing icon and screen-reader text.
 */
.priority-wrapper {
    display: inline-flex;
    align-items: center;
}

/**
 * Visually hidden but accessible to screen readers.
 * WCAG-compliant hidden text pattern.
 */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* ==========================================================================
   Alternative Icon Styles
   ========================================================================== */

/**
 * Badge style - shows colored badge with icon/text.
 */
.priority-icon.priority-icon--badge {
    width: auto;
    padding: 0.125rem 0.5rem;
    border-radius: 0.625rem;
    font-size: 0.625rem;
    font-weight: 700;
    color: #fff;
}

.priority-icon.priority-icon--badge::after {
    content: attr(data-label);
    position: static;
    opacity: 1;
    visibility: visible;
    background: transparent;
    padding: 0;
    margin-inline-start: 0.25rem;
    transform: none;
}

/**
 * Dot style - minimal indicator.
 */
.priority-icon.priority-icon--dot {
    width: 8px;
    height: 8px;
}

.priority-icon.priority-icon--dot::after,
.priority-icon.priority-icon--dot::before {
    display: none;
}

/* ==========================================================================
   osTicket Integration - Table Styles
   ========================================================================== */

/**
 * Tinted background for priority table cells.
 * Uses the --priority-color set by JS on the td element.
 */
td[data-priority-cell] {
    background-color: color-mix(in srgb, var(--priority-color) 12%, white);
}

/**
 * Center icons vertically in ticket queue table cells.
 */
table.list.queue.tickets td .priority-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
}

/**
 * Prevent shrinking in narrow columns.
 */
table.list.queue.tickets td .priority-icon {
    flex-shrink: 0;
}

/**
 * Ticket preview panel integration.
 */
.ticket_info .priority-wrapper,
.ticket-info .priority-wrapper {
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

/* ==========================================================================
   Print Styles
   ========================================================================== */

@media print {
    .priority-icon {
        /* Preserve colors in print */
        print-color-adjust: exact;
        -webkit-print-color-adjust: exact;
    }

    /* Hide tooltips in print */
    .priority-icon::after,
    .priority-icon::before {
        display: none;
    }

    /* Disable animations */
    .priority-icon.priority-emergency {
        animation: none;
    }
}

/* ==========================================================================
   Dark Mode Support (Future Enhancement)
   ========================================================================== */

@media (prefers-color-scheme: dark) {
    :root {
        --priority-tooltip-bg: #f8f9fa;
        --priority-tooltip-color: #212529;
    }
}
